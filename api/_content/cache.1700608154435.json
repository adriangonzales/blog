{"generatedAt":1700608160191,"generateTime":7,"contents":[{"_path":"/authors","_dir":"","_draft":false,"_partial":false,"_locale":"","Adrian Gonzales":{"@context":"http://www.schema.org","@type":"Person","@id":"https://virexmachina.com/","name":"Adrian Gonzales","alternateName":"Adrian Gonzales","jobTitle":"CTO","worksFor":[{"@type":"Organization","name":"MarketMuscles","sameAs":["https://marketmuscles.com/"]}],"url":"https://virexmachina.com/","image":"https://virexmachina.com/img/card-og.png","sameAs":["https://virexmachina.com/"]},"_id":"content:authors.json","_type":"json","title":"Authors","_source":"content","_file":"authors.json","_extension":"json"},{"_path":"/blog/2015-02-28-starting-again","_dir":"blog","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Starting Again, Without WordPress","description":"I've tried blogging for years. I wrote my first blog in ColdFusion in 2002, rewrote crude versions in PHP a few times before Matt dropped Wordpress on us at the local Blogger meetups, started extended writing habits on various web services and open source platforms from MovableType and Textpattern to LiveJornal and Tumblr.","headline":"Starting Again, Without WordPress","date":"2015-02-28T00:00:00.000Z","tags":"wordpress, jekyll, development, featured","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I've tried blogging for years. I wrote my first blog in ColdFusion in 2002, rewrote crude versions in PHP a few times before Matt dropped Wordpress on us at the local Blogger meetups, started extended writing habits on various web services and open source platforms from MovableType and Textpattern to LiveJornal and Tumblr."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This time around, I'm trying "},{"type":"element","tag":"a","props":{"href":"http://jekyllrb.com/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Jekyll"}]},{"type":"text","value":". If you know me, I live and breath WordPress daily, so a Ruby-based static site generator might seem like a pretty odd choice. But in the end, it provides dead simple content management while retaining direct control over the guts of the site."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I don't mean this as criticism of WordPress. It's an amazing example of the "},{"type":"element","tag":"a","props":{"href":"http://en.wikipedia.org/wiki/Pareto_principle","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"80/20 rule"}]},{"type":"text","value":", covering the needs of the vast majority of web publishing scenarios. "},{"type":"element","tag":"a","props":{"href":"http://www.uptrending.com/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Where I work"}]},{"type":"text","value":", we push that 80% hard, outfiting WordPress with modern interfaces and superpowers like marketing automation, user generated content, and API integrations."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"WordPress's intended user base is non-developer marketing staff and it excels at providing a powerful, flexible interface that serves that audience. For this site, though, I want to be able to control my code, repurposing a page at a whim. But I still enjoy having total control over the code and hate managing databases when I don't have to."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Enter Jekyll: it's lightweight, dependent only on my local system for build and it's hosted simply on Github. I can write my posts and pages in markdown or HTML and I don't have to worry about URL management, page creation, templating, etc."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Honestly, it also keeps me from getting lost in writing huge custom features and never finishing them. The static nature of Jekyll is a major shift in perspective from the realtime, dynamic webapp world I'm used to. I think that challenge to the status quo is a big asset."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Its easy to get lost in the tool you use most. WordPress, Rails, Laravel, Node, Angular, it doesn't matter. There's usually an opinion of a \"best\" platform, but truthfully none of them fit every scenario and some are better suited to others."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When all you have is a hammer, everything looks like a nail."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Just like this site, sometimes Wordpress isn't the best fit. If I don't try new options, I'd never know. So, this is my forray into production usage of a static site generator. Perhaps I'll get frustrated by the confines of runtime generation, or, maybe coloring in the lines is another way of defining the canvas. For now, I'm enjoying the flexiblity of a static site without all the fuss of manually managing site assets and layout changes. And when I do recommend WordPress, I'll be confident that it's the right tool for the job."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:blog:2015-02-28-starting-again.md","_source":"content","_file":"blog/2015-02-28-starting-again.md","_extension":"md"},{"_path":"/blog/2015-10-08-better-wordpress-cron-jobs-crontab-wpcli","_dir":"blog","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"Better Wordpress Cron Jobs with crontab and WP CLI","description":"WP Cron jobs can be powerful tools, allowing you to schedule tasks that need to happen automatically. Unfortunately, by default, this only runs on a page visit.","headline":"Better Wordpress Cron Jobs with crontab and WP CLI","date":"2015-10-08T00:00:00.000Z","tags":"wordpress, cron, wpcli","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"WP Cron jobs can be powerful tools, allowing you to schedule tasks that need to happen automatically. Unfortunately, by default, this only runs on a page visit."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That means two things for you:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Jobs only run when there's visitors actively on the site when its supposed to run"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"A log running job will hold up the page render for the unlucky visitors that trigger it"}]}]},{"type":"element","tag":"h3","props":{"id":"so-how-do-you-do-that-better"},"children":[{"type":"text","value":"So, how do you do that better?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Crontab is a great solution for running cron jobs, its what your server does for its own jobs. But getting it to execute tasks can be a little tricky. Theres workaround requiring your server to call "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"curl http://yoursite.com/wp-cron.php"}]},{"type":"text","value":", but that relies on curl and that domain is resolvable from the server."}]},{"type":"element","tag":"h3","props":{"id":"wp-cli-to-the-rescue"},"children":[{"type":"text","value":"WP-CLI to the rescue"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"WP CLI has the ability to run cron jobs itself. It does this intelligently, obeying the set schedule even when its run outside the task's window. So that means we can safely run that command on a minute interval."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This command runs a cron job, but you notice, it needs the hook name and can only run one at a time"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"wp cron event run cron_job_hook_name"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This command lists all cron jobs available"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"wp cron event list"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"So, we take that and only get the hook, no formatting."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"wp cron event list --fields=hook --format=ids"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then we're going to wrap that in a bash loop so that each hook that gets returned runs the cron job."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"for i in $(wp cron event list --fields=hook --format=ids); do wp cron event run $i; done"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That'll run them all! But since this is a cron job, it'll run outside our normal bash environment. So, we need to specify where the site is with: "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"--path=/full/path/to/site"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"for i in $(wp cron event list --fields=hook --format=ids --path=/full/path/to/site); do wp cron event run $i --path=/full/path/to/site; done"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Notice how we have to do that in the list command "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"and"}]},{"type":"text","value":" the run command."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sometimes, depending on how you set up WP-CLI, you'll need to specify it's location too, like "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/usr/local/bin/"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"for i in $(/usr/local/bin/wp cron event list --fields=hook --format=ids --path=/full/path/to/site); do /usr/local/bin/wp cron event run $i --path=/full/path/to/site; done"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Awesome, so this should run great, lets put it in a cron job."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That runs all WP cron jobs, every 5 minutes (*/12 is 60 minutes/12 = 5 minutes)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"*/12 * * * * for i in $(/usr/local/bin/wp cron event list --fields=hook --format=ids --path=/full/path/to/site); do /usr/local/bin/wp cron event run $i --quiet --path=/full/path/to/site; done"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note I added "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"--quiet"}]},{"type":"text","value":" to the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"run"}]},{"type":"text","value":" command so that I don't get an email every time this runs."}]},{"type":"element","tag":"h3","props":{"id":"root-problems"},"children":[{"type":"text","value":"root problems"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sometimes you'll have to run this as a root user, which WP CLI will warn you about. If you're comfortable with running this under root, WP-CLI has "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"--allow-root"}]},{"type":"text","value":" as well"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"*/12 * * * * for i in $(/usr/local/bin/wp cron event list --fields=hook --format=ids --path=/full/path/to/site --allow-root); do /usr/local/bin/wp cron event run $i --quiet --path=/full/path/to/site --allow-root; done"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Again, note that you must "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"--allow-root"}]},{"type":"text","value":" on both commands."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There ya go, now you can disable WP's cron runner by adding this to your wp-config.php"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"define( 'DISABLE_WP_CRON', true );"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Hope that helps!"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"so-how-do-you-do-that-better","depth":3,"text":"So, how do you do that better?"},{"id":"wp-cli-to-the-rescue","depth":3,"text":"WP-CLI to the rescue"},{"id":"root-problems","depth":3,"text":"root problems"}]}},"_type":"markdown","_id":"content:blog:2015-10-08-better-wordpress-cron-jobs-crontab-wpcli.md","_source":"content","_file":"blog/2015-10-08-better-wordpress-cron-jobs-crontab-wpcli.md","_extension":"md"},{"_path":"/blog/high-level-decrypting-sso-sessions-with-php","_dir":"blog","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"HighLevel: Decrypting SSO sessions with PHP | Adrian Gonzales","description":"Using PHP to decrypt the HighLevel SSO payload","excerpt":"Using PHP to decrypt the HighLevel SSO payload","headline":"HighLevel: Decrypting SSO sessions with PHP","date":"2023-11-21T12:00:00","dateUpdated":"","author":"Adrian Gonzales","authorUrl":"https://virexmachina.com/","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I'm working on an extensive custom integration with "},{"type":"element","tag":"a","props":{"href":"https://www.gohighlevel.com/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"HighLevel"}]},{"type":"text","value":", now possible because they recently built a single-sign-on process that allows web applications embedded in iFrames to validate that they are being loaded within the HL interface, as well as retrieve information about the current user and account viewing the application."}]},{"type":"element","tag":"h3","props":{"id":"the-challenge"},"children":[{"type":"text","value":"The Challenge"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This process is an interesting challenge due to security concerns and cross-domain resources loaded in iFrames."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The official documentation around this feature is very limited, mostly "},{"type":"element","tag":"a","props":{"href":"https://github.com/GoHighLevel/ghl-marketplace-app-template#sso","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"this example implementation"}]},{"type":"text","value":". Thankfully, talented people are sharing their knowledge, like "},{"type":"element","tag":"a","props":{"href":"https://www.youtube.com/watch?v=3rveQDuVlR0","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Sergio Leon's video explaining the SSO process"}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"https://seankerr.dev/posts/decrypting-highlevel-sso-session-using-python/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Sean Kerr's blog post adapting the process to Python"}]},{"type":"text","value":". The obvious challenge was implementing the decryption logic in PHP."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"HighLevel uses "},{"type":"element","tag":"a","props":{"href":"https://github.com/brix/crypto-js","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"CryptoJS"}]},{"type":"text","value":" to encode the SSO payload. Unfortunately, as Sean found out, CryptoJS's default implementation does not use a standard approach to encryption."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The crux of the problem is two parts:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CryptoJS is using the same prefix as OpenSSL when encrypting AES data."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Itâ€™s using MD5 instead of SHA256 as a hashing mechanism, and it only does a single iteration instead of thousands (more secure)."}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sean's post showed me why neither "},{"type":"element","tag":"a","props":{"href":"https://laravel.com/docs/10.x/encryption","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Laravel's Encryption service"}]},{"type":"text","value":" nor a basic "},{"type":"element","tag":"a","props":{"href":"https://www.php.net/manual/en/function.openssl-decrypt.php","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"OpenSSL decrypt"}]},{"type":"text","value":" implementation were working. After some rounds of interpreting their Python example to PHP, I ended up back at Google assuming someone somewhere had run into this problem before."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As usual, StackOverflow came to the rescue, with a question aptly titled "},{"type":"element","tag":"a","props":{"href":"https://stackoverflow.com/a/65235352","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Decrypt Crypto-js encrypted text with key with PHP"}]},{"type":"text","value":". The answer's code showed PHP's "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hash_init"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hash_update"}]},{"type":"text","value":", and "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hash_final"}]},{"type":"text","value":" methods matched the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hasher"}]},{"type":"text","value":" update and digest functionality in Python."}]},{"type":"element","tag":"h3","props":{"id":"code"},"children":[{"type":"text","value":"Code"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here's the functionality, cleaned up a little and implemented as a class. I avoided using parameter and return types for increased compatibility."}]},{"type":"element","tag":"code","props":{"code":"/**\n * CryptoJS compatibility module\n */\nclass CryptoJs\n{\n    /**\n     * Decrypt a payload encrypted with a passphrase\n     *\n     * @see https://stackoverflow.com/a/65235352\n     *\n     * @param string $payload\n     * @param string $passphrase\n     * @return string\n     */\n    public static function decrypt($payload, $passphrase)\n    {\n        $ciphertext = base64_decode($payload);\n\n        if (substr($ciphertext, 0, 8) != \"Salted__\") {\n            return false;\n        }\n\n        $salt = substr($ciphertext, 8, 8);\n\n        $keyAndIV = self::deriveKeyAndIv($passphrase, $salt);\n\n        return openssl_decrypt(\n            substr($ciphertext, 16),\n            \"aes-256-cbc\",\n            $keyAndIV[\"key\"],\n            OPENSSL_RAW_DATA, // base64 was already decoded\n            $keyAndIV[\"iv\"]\n        );\n    }\n\n    /**\n     * Derive key from the given passphrase and salt.\n     *\n     * @param string $passphrase\n     * @param string $salt\n     * @param integer $keySize\n     * @param integer $ivSize\n     * @param integer $iterations\n     * @param string $hashAlgorithm\n     * @return void\n     */\n    private static function deriveKeyAndIv($passphrase, $salt, $keySize = 8, $ivSize = 4, $iterations = 1, $hashAlgorithm = \"md5\")\n    {\n        $targetKeySize = $keySize + $ivSize;\n        $derivedBytes = \"\";\n        $numberOfDerivedWords = 0;\n        $block = NULL;\n        $hasher = hash_init($hashAlgorithm);\n\n        while ($numberOfDerivedWords < $targetKeySize) {\n            if ($block != NULL) {\n                hash_update($hasher, $block);\n            }\n\n            hash_update($hasher, $passphrase);\n            hash_update($hasher, $salt);\n            $block = hash_final($hasher, TRUE);\n            $hasher = hash_init($hashAlgorithm);\n\n            // Iterations\n            for ($i = 1; $i < $iterations; $i++) {\n                hash_update($hasher, $block);\n                $block = hash_final($hasher, TRUE);\n                $hasher = hash_init($hashAlgorithm);\n            }\n\n            $derivedBytes .= substr($block, 0, min(strlen($block), ($targetKeySize - $numberOfDerivedWords) * 4));\n            $numberOfDerivedWords += strlen($block) / 4;\n        }\n\n        return array(\n            \"key\" => substr($derivedBytes, 0, $keySize * 4),\n            \"iv\"  => substr($derivedBytes, $keySize * 4, $ivSize * 4)\n        );\n    }\n}\n","language":"php","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"/**"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" * CryptoJS compatibility module"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" */"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-22037f"},"children":[{"type":"text","value":"CryptoJs"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"/**"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * Decrypt a payload encrypted with a passphrase"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     *"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@see"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" https://stackoverflow.com/a/65235352"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     *"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $payload"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $passphrase"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@return"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"string"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     */"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"static"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-67bea5"},"children":[{"type":"text","value":"decrypt"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($payload, $passphrase)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $ciphertext "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"base64_decode"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($payload);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($ciphertext, "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"!="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"Salted__\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $salt "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($ciphertext, "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $keyAndIV "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"self::"}]},{"type":"element","tag":"span","props":{"class":"ct-67bea5"},"children":[{"type":"text","value":"deriveKeyAndIv"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($passphrase, $salt);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"openssl_decrypt"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($ciphertext, "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"16"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"aes-256-cbc\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            $keyAndIV["}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"key\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"OPENSSL_RAW_DATA"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"// base64 was already decoded"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            $keyAndIV["}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"iv\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        );"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"/**"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * Derive key from the given passphrase and salt."}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     *"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $passphrase"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $salt"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"integer"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $keySize"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"integer"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $ivSize"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"integer"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $iterations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" $hashAlgorithm"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"@return"}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"void"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"     */"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"private"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"static"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-67bea5"},"children":[{"type":"text","value":"deriveKeyAndIv"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($passphrase, $salt, $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", $ivSize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", $iterations "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", $hashAlgorithm "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"md5\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $targetKeySize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" $ivSize;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $derivedBytes "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $numberOfDerivedWords "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $block "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"NULL"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        $hasher "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_init"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hashAlgorithm);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"while"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" ($numberOfDerivedWords "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" $targetKeySize) {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" ($block "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"!="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"NULL"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hasher, $block);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hasher, $passphrase);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hasher, $salt);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            $block "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_final"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hasher, "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"TRUE"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            $hasher "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_init"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hashAlgorithm);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-55828c"},"children":[{"type":"text","value":"// Iterations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" ($i "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"; $i "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" $iterations; $i"}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hasher, $block);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"                $block "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_final"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hasher, "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"TRUE"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"                $hasher "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"hash_init"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($hashAlgorithm);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            $derivedBytes "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":".="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($block, "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"min"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"strlen"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($block), ($targetKeySize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" $numberOfDerivedWords) "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"));"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            $numberOfDerivedWords "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"strlen"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($block) "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"array"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"key\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($derivedBytes, "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-bf34ea"},"children":[{"type":"text","value":"\"iv\""}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($derivedBytes, $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":", $ivSize "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"        );"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This class can be used to decrypt the SSO payload like this:"}]},{"type":"element","tag":"code","props":{"code":"$data = CryptoJs::decrypt($ssoPayload, $ssoPassphrase);\n","language":"php","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"$data "}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-bc0c4f"},"children":[{"type":"text","value":"CryptoJs"}]},{"type":"element","tag":"span","props":{"class":"ct-5cb295"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-67bea5"},"children":[{"type":"text","value":"decrypt"}]},{"type":"element","tag":"span","props":{"class":"ct-d1fffb"},"children":[{"type":"text","value":"($ssoPayload, $ssoPassphrase);"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Good luck on your implementation!"}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-bf34ea{color:#A5D6FF}\n.ct-bc0c4f{color:#79C0FF}\n.ct-67bea5{color:#D2A8FF}\n.ct-22037f{color:#FFA657}\n.ct-d1fffb{color:#C9D1D9}\n.ct-5cb295{color:#FF7B72}\n.ct-55828c{color:#8B949E}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"the-challenge","depth":3,"text":"The Challenge"},{"id":"code","depth":3,"text":"Code"}]}},"_type":"markdown","_id":"content:blog:high-level-decrypting-sso-sessions-with-php.md","_source":"content","_file":"blog/high-level-decrypting-sso-sessions-with-php.md","_extension":"md"},{"_path":"/blog/high-level-sso-custom-links","_dir":"blog","_draft":false,"_partial":false,"_locale":"","_empty":false,"title":"HighLevel: Utilizing SSO sessions from inside Custom Links | Adrian Gonzales","description":"You can use SSO sessions from inside Custom Links, not just custom pages","excerpt":"You can use SSO sessions from inside Custom Links, not just custom pages","headline":"HighLevel: Utilizing SSO sessions from inside Custom Links","date":"2023-11-22T12:00:00","dateUpdated":"","author":"Adrian Gonzales","authorUrl":"https://virexmachina.com/","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I'm working on an extensive custom integration with "},{"type":"element","tag":"a","props":{"href":"https://www.gohighlevel.com/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"HighLevel"}]},{"type":"text","value":", now possible because they recently built a single-sign-on process that allows web applications embedded in iFrames to validate that they are being loaded within the HL interface, as well as retrieve information about the current user and account viewing the application."}]},{"type":"element","tag":"h3","props":{"id":"the-challenge"},"children":[{"type":"text","value":"The Challenge"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This process is an interesting challenge due to security concerns and cross-domain resources loaded in iFrames."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The official documentation around this feature is very limited, mostly "},{"type":"element","tag":"a","props":{"href":"https://github.com/GoHighLevel/ghl-marketplace-app-template#sso","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"this example implementation"}]},{"type":"text","value":". Thankfully, talented people are sharing their knowledge, like "},{"type":"element","tag":"a","props":{"href":"https://www.youtube.com/watch?v=3rveQDuVlR0","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Sergio Leon's video explaining the SSO process"}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"https://seankerr.dev/posts/decrypting-highlevel-sso-session-using-python/","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Sean Kerr's blog post adapting the process to Python"}]},{"type":"text","value":". The obvious challenge was implementing the decryption logic in PHP."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"HighLevel uses "},{"type":"element","tag":"a","props":{"href":"https://github.com/brix/crypto-js","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"CryptoJS"}]},{"type":"text","value":" to encode the SSO payload. Unfortunately, as Sean found out, CryptoJS's default implementation does not use a standard approach to encryption."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The crux of the problem is two parts:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CryptoJS is using the same prefix as OpenSSL when encrypting AES data."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Itâ€™s using MD5 instead of SHA256 as a hashing mechanism, and it only does a single iteration instead of thousands (more secure)."}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sean's post showed me why neither "},{"type":"element","tag":"a","props":{"href":"https://laravel.com/docs/10.x/encryption","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Laravel's Encryption service"}]},{"type":"text","value":" nor a basic "},{"type":"element","tag":"a","props":{"href":"https://www.php.net/manual/en/function.openssl-decrypt.php","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"OpenSSL decrypt"}]},{"type":"text","value":" implementation were working. After some rounds of interpreting their Python example to PHP, I ended up back at Google assuming someone somewhere had run into this problem before."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As usual, StackOverflow came to the rescue, with a question aptly titled "},{"type":"element","tag":"a","props":{"href":"https://stackoverflow.com/a/65235352","rel":["noopener","noreferer"],"target":"_blank"},"children":[{"type":"text","value":"Decrypt Crypto-js encrypted text with key with PHP"}]},{"type":"text","value":". The answer's code showed PHP's "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hash_init"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hash_update"}]},{"type":"text","value":", and "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hash_final"}]},{"type":"text","value":" methods matched the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"hasher"}]},{"type":"text","value":" update and digest functionality in Python."}]},{"type":"element","tag":"h3","props":{"id":"code"},"children":[{"type":"text","value":"Code"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here's the functionality, cleaned up a little and implemented as a class. I avoided using parameter and return types for increased compatibility."}]},{"type":"element","tag":"code","props":{"code":"/**\n * CryptoJS compatibility module\n */\nclass CryptoJs\n{\n    /**\n     * Decrypt a payload encrypted with a passphrase\n     *\n     * @see https://stackoverflow.com/a/65235352\n     *\n     * @param string $payload\n     * @param string $passphrase\n     * @return string\n     */\n    public static function decrypt($payload, $passphrase)\n    {\n        $ciphertext = base64_decode($payload);\n\n        if (substr($ciphertext, 0, 8) != \"Salted__\") {\n            return false;\n        }\n\n        $salt = substr($ciphertext, 8, 8);\n\n        $keyAndIV = self::deriveKeyAndIv($passphrase, $salt);\n\n        return openssl_decrypt(\n            substr($ciphertext, 16),\n            \"aes-256-cbc\",\n            $keyAndIV[\"key\"],\n            OPENSSL_RAW_DATA, // base64 was already decoded\n            $keyAndIV[\"iv\"]\n        );\n    }\n\n    /**\n     * Derive key from the given passphrase and salt.\n     *\n     * @param string $passphrase\n     * @param string $salt\n     * @param integer $keySize\n     * @param integer $ivSize\n     * @param integer $iterations\n     * @param string $hashAlgorithm\n     * @return void\n     */\n    private static function deriveKeyAndIv($passphrase, $salt, $keySize = 8, $ivSize = 4, $iterations = 1, $hashAlgorithm = \"md5\")\n    {\n        $targetKeySize = $keySize + $ivSize;\n        $derivedBytes = \"\";\n        $numberOfDerivedWords = 0;\n        $block = NULL;\n        $hasher = hash_init($hashAlgorithm);\n\n        while ($numberOfDerivedWords < $targetKeySize) {\n            if ($block != NULL) {\n                hash_update($hasher, $block);\n            }\n\n            hash_update($hasher, $passphrase);\n            hash_update($hasher, $salt);\n            $block = hash_final($hasher, TRUE);\n            $hasher = hash_init($hashAlgorithm);\n\n            // Iterations\n            for ($i = 1; $i < $iterations; $i++) {\n                hash_update($hasher, $block);\n                $block = hash_final($hasher, TRUE);\n                $hasher = hash_init($hashAlgorithm);\n            }\n\n            $derivedBytes .= substr($block, 0, min(strlen($block), ($targetKeySize - $numberOfDerivedWords) * 4));\n            $numberOfDerivedWords += strlen($block) / 4;\n        }\n\n        return array(\n            \"key\" => substr($derivedBytes, 0, $keySize * 4),\n            \"iv\"  => substr($derivedBytes, $keySize * 4, $ivSize * 4)\n        );\n    }\n}\n","language":"php","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"/**"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" * CryptoJS compatibility module"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" */"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-e3c07e"},"children":[{"type":"text","value":"CryptoJs"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"{"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"/**"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * Decrypt a payload encrypted with a passphrase"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     *"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@see"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" https://stackoverflow.com/a/65235352"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     *"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $payload"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $passphrase"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@return"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"string"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     */"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"public"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"static"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-2c0d74"},"children":[{"type":"text","value":"decrypt"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($payload, $passphrase)"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $ciphertext "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"base64_decode"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($payload);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" ("}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($ciphertext, "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"!="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"Salted__\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"false"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $salt "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($ciphertext, "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $keyAndIV "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"self::"}]},{"type":"element","tag":"span","props":{"class":"ct-2c0d74"},"children":[{"type":"text","value":"deriveKeyAndIv"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($passphrase, $salt);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"openssl_decrypt"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($ciphertext, "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"16"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"aes-256-cbc\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":","}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            $keyAndIV["}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"key\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"],"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"OPENSSL_RAW_DATA"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"// base64 was already decoded"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            $keyAndIV["}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"iv\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"]"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        );"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"/**"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * Derive key from the given passphrase and salt."}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     *"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $passphrase"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $salt"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"integer"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $keySize"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"integer"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $ivSize"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"integer"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $iterations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@param"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"string"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" $hashAlgorithm"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     * "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"@return"}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"void"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"     */"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"private"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"static"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-2c0d74"},"children":[{"type":"text","value":"deriveKeyAndIv"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($passphrase, $salt, $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"8"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", $ivSize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", $iterations "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", $hashAlgorithm "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"md5\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $targetKeySize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" $ivSize;"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $derivedBytes "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $numberOfDerivedWords "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $block "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"NULL"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        $hasher "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_init"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hashAlgorithm);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"while"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" ($numberOfDerivedWords "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" $targetKeySize) {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"if"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" ($block "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"!="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"NULL"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hasher, $block);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hasher, $passphrase);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hasher, $salt);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            $block "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_final"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hasher, "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"TRUE"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            $hasher "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_init"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hashAlgorithm);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-8628c1"},"children":[{"type":"text","value":"// Iterations"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" ($i "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"; $i "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" $iterations; $i"}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"++"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":") {"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"                "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_update"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hasher, $block);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"                $block "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_final"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hasher, "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"TRUE"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":");"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"                $hasher "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"hash_init"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($hashAlgorithm);"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            $derivedBytes "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":".="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($block, "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"min"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"strlen"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($block), ($targetKeySize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"-"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" $numberOfDerivedWords) "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"));"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            $numberOfDerivedWords "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"+="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"strlen"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($block) "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"/"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":";"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"return"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"array"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"("}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"key\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($derivedBytes, "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"),"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"            "}]},{"type":"element","tag":"span","props":{"class":"ct-00fbf0"},"children":[{"type":"text","value":"\"iv\""}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"  "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"substr"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($derivedBytes, $keySize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":", $ivSize "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"*"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"4"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":")"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"        );"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"    }"}]}]},{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This class can be used to decrypt the SSO payload like this:"}]},{"type":"element","tag":"code","props":{"code":"$data = CryptoJs::decrypt($ssoPayload, $ssoPassphrase);\n","language":"php","meta":null},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"div","props":{"class":"line"},"children":[{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"$data "}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":" "}]},{"type":"element","tag":"span","props":{"class":"ct-4b8fd7"},"children":[{"type":"text","value":"CryptoJs"}]},{"type":"element","tag":"span","props":{"class":"ct-3beffc"},"children":[{"type":"text","value":"::"}]},{"type":"element","tag":"span","props":{"class":"ct-2c0d74"},"children":[{"type":"text","value":"decrypt"}]},{"type":"element","tag":"span","props":{"class":"ct-a830ca"},"children":[{"type":"text","value":"($ssoPayload, $ssoPassphrase);"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Good luck on your implementation!"}]},{"type":"element","tag":"style","children":[{"type":"text","value":".ct-00fbf0{color:#A5D6FF}\n.ct-4b8fd7{color:#79C0FF}\n.ct-2c0d74{color:#D2A8FF}\n.ct-e3c07e{color:#FFA657}\n.ct-a830ca{color:#C9D1D9}\n.ct-3beffc{color:#FF7B72}\n.ct-8628c1{color:#8B949E}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"the-challenge","depth":3,"text":"The Challenge"},{"id":"code","depth":3,"text":"Code"}]}},"_type":"markdown","_id":"content:blog:high-level-sso-custom-links.md","_source":"content","_file":"blog/high-level-sso-custom-links.md","_extension":"md"}],"navigation":[{"title":"Authors","_path":"/authors"},{"title":"Blog","_path":"/blog","children":[{"title":"Starting Again, Without WordPress","_path":"/blog/2015-02-28-starting-again"},{"title":"Better Wordpress Cron Jobs with crontab and WP CLI","_path":"/blog/2015-10-08-better-wordpress-cron-jobs-crontab-wpcli"},{"title":"HighLevel: Decrypting SSO sessions with PHP | Adrian Gonzales","_path":"/blog/high-level-decrypting-sso-sessions-with-php"},{"title":"HighLevel: Utilizing SSO sessions from inside Custom Links | Adrian Gonzales","_path":"/blog/high-level-sso-custom-links"}]}]}